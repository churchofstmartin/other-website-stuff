#+TITLE: stMartinTest notes
#+AUTHOR: Gail Gong
#+DATE: 2012-09-20

#+LATEX_HEADER: \usepackage{amscd}
#+LATEX_HEADER: \usepackage{parskip}
#+LATEX_HEADER: \usepackage{amsmath}
#+LATEX_HEADER: \usepackage{multirow}
#+LATEX_HEADER: \usepackage[table]{xcolor}
#+LATEX_HEADER: \addtolength{\oddsidemargin}{-1.0in}
#+LATEX_HEADER: \addtolength{\evensidemargin}{-1.0in}
#+LATEX_HEADER: \addtolength{\textwidth}{2.0in}

#+LATEX_HEADER: \addtolength{\topmargin}{-1.5in}
#+LATEX_HEADER: \addtolength{\textheight}{2.3in}

#+STYLE:    <link rel="stylesheet" type="text/css" href="./html-skeleton.css" />
#+PROPERTY: session *R*
#+PROPERTY: cache no
#+PROPERTY: results output verbatim
#+PROPERTY: exports both
#+PROPERTY: tangle yes

# <<TOP>>


http://ec2-54-245-119-78.us-west-2.compute.amazonaws.com/wp-admin

* 2012-09-20
** Mike
- To log in to the website
  ssh -i stmtest.pem ubuntu@ec2-54-245-119-78.us-west-2.compute.amazonaws.com
- Moved all the wordpress files to the top level directory.
- Cloned TheTwentytenStm from github.
- sudo chown -R www-data.www-data TheTwentytenStm
- Installed wp-cycle.

** Turn on website on laptop so I can compare to what I had before
Gail-Gongs-MacBook-Pro:~ gailgong$ cd /Applications/wordpress-3.4-0/
Gail-Gongs-MacBook-Pro:wordpress-3.4-0 gailgong$ ./ctlscript.sh start
localhost:8080/wordpress/wp-admin

** Login to wordpress website
http://ec2-54-245-119-78.us-west-2.compute.amazonaws.com/wp-admin
r
hint: stillmotion workshop  - - /

** Set up the TheTwentyTenStm stuff, including header, front page, and sidebar
dashboard
themes
0. activate TheTwentytenStm
1. Set permalink to day and link
2. upload header image
   themes > header > TheTwentytenStm/images/header-image-png > upload
3. turn off comments
   settings > discussion > check the following:
   Basically, turn off Allow people to post comments on new articles
4. Front page
   Some pictures of our family...
   [wp_cycle]
   Newsletter  Podcasts Photo Gallery Calendar
5. Set it to be the front page
   Settings > Reading > A static page > Some pictures of our family...
6. Adjust wp-cycle settings
   plugins > installed plugins > wp-cycle >
   width 700 height 467
   upload images; they can't be too large
   Ask Gail to export from lightroom quality 25% and reorder using bridge
7. Fix sidebar step 1
   widgets > primary widget area > recents posts > Announcements
   Remove everything except recent posts and search
8. Fix sidebar step 2
   plugins > add new > Floating Social Media Icon > install > activate
   Floating Social Media Settings > Theme 19
   Put in links for facebook, twitter and rss feed
   Display mode: Manual only (using shortcode or php code--will not
   float)
   update
9. Add the image sizes in settings > media
   - thumbnail 175 117
   - medium 233 157
   - large 350 233
   - was 1024 1024

10. Create the Header Menu
    Appearance > Menus >  Menu Name > Header Menu > Create Menu
    Primary Navigation > Header Menu
    Drag in Some pictures of our family > Navigation Label > HOME
    Drag in Welcome to St. Martin's > Navigation Label WELCOME/ABOUT
    US

11. Photos like the ones in Regular Services 
    have aspect ratio 3.5 x 1
    and are brought in using center and full size
12. Photos like the ones in Staff and Vestry
    are brought in using left or right and medium size

13. Headings in the Staff and Vestry 
    are Heading 3

** Organize files from Gerard

*** 2012-09-18 First batch for web suite - 3 files
Here are the three documents for the "Serving Others" menu.
 
5A What we do.  Needs a link completed to 5B
5B Grants Awarded.  Photo?
5C Davis Community Meals.  More photos?  

From Janet:
I just noticed one tiny mistake. At the vert bottom of 5B Grants
Awarded, the phrase Yolo Wayfarer Center is listed. Please delete it
as it is listed above under "regional." Sorry I did not catch that
before. 

Or we can catch it in the testing phase if that is easier for you.

*** 2012-09-18 Web site information - second batch - 6 files
Here is some more information to plug in under the Welcome / About us menu:
 
**** 2A Welcome.  Needs 4 links coded.  Photo.
  [[./../photos/website-2012-06/mark-birthday-prayer-pentecost-02-2012.jpg]]

  [[./../photos/website-2012-07/mark-sermon-03-pentecost-08-2012.jpg]]

**** 2B Address / Map.  Needs map inserted.  Photo - suggest outside of church.
**** 2C Staff / Vestry.  Needs photo of Janie.
**** 2E Ministries. 
  - Needs links to Ministry leaders2F  
  - Needs photos.
  - Needs image/link to Order of St Luke
  - Needs image/link to Stephen Ministry
  - Choirs needs link to music (3D)
  
**** 2F Ministies Leaders.  Nothing needed.  
define a macro: c-x ( > do the stuff > c-x) > c-x e > e
select a rectangle: go to beginning > c-space > go to end > c-x r k
paste a rectange: go to the place > c-x r y
sort a table c-c ^
org-export-region-as-html 

| Acolyte Program                             | Robert Lynch                          |
| Administrator/ Office Volunteer Coordinator | Jan Sanders                           |
| Altar Guild                                 | Nancy Crummey, Dawn Preisler          |
| Belfry University Ministry                  | Elise Keddie, Jim Cheney              |
| Buildings and Grounds                       | John Reeves, Mike Rushton             |
| Centering Prayer Group                      | Kim Andrup                            |
| Child care/Nursery (Sundays)                | Mary Honour Gottschalk                |
| Children’s Choir Director                   | Janie Knudsen                         |
| Coffee Hour Coordinators                    | Sharon Cucinotta (coffee)             |
|                                             | Janet Lane & Bob Holm (food)          |
| Communications Commission                   | Mike Hannon                           |
| Concerts and Concert Series                 | Gerard Montana                        |
| Craft Fair Coordinator                      | Carol Boyer                           |
| Cursillo                                    | Russ Bruch                            |
| Davis Community Meal Liaison                | Janet Lane, Neil Willits, Mike Hannon |
| Flower Guild                                | Anne Duffey                           |
| Healing Ministry                            | Margaret Grayden                      |
| Helping Hands                               | Jim and Alice Borchers                |
| Hospitality                                 | Brian Shontz, Sharon Cucinotta        |
| Junior Warden                               | Janet Lane                            |
| Labyrinth Cleaning                          | Helen Campbell                        |
| Lay Eucharistic Ministers                   | The Rev. Ernie Lewis                  |
| Lector/Readers Coordinator                  | Jan Sanders                           |
| Library Book Coordinator                    | Elizabeth Honig                       |
| Music Director                              | Gerard Montana                        |
| Newsletter Editor                           | Elizabeth Sagehorn                    |
| Outreach Commission Co-chairs               | Renee Crevelli-Gross, Alison Pease    |
| Parish Commission on Ministry               | Nancy Allen                           |
| Photography                                 | Gail Gong, Nate Hannon, Fel Ramey     |
| Podcasts of services                        | Bruce Winterhalder                    |
| Senior Warden                               | Pierre Neu                            |
| Stephen Ministry                            | Margaret Grayden, Carla Harris        |
| Stewardship Chair                           | Neil Willits                          |
| Sunday School/Godly Play                    | Lisa Leigh, Dee Garcia                |
| Telecom/Technology                          | Craig Harris                          |
| Transportation Assistance                   | Adam Russ                             |
| Treasurer                                   | Stephen Lawrence                      |
| Ushers/Greeters                             | Russ Bruch                            |
| Volunteer Gifts Coordinator                 | Lynn Zender                           |
| Webmaster                                   | Mary Briggs                           |
| Worship                                     | The Rev. Mark Allen                   |
| Youth Group (TYGMOS)                        | Lisa Leigh, Robert Lynch              |

**** table sorting experiment

| larry  | seaweed  |
| monty  | clams    |
| sangea | potatoes |

**** 2I  Social Activities.  Needs photos
 
**** 2G
**** 2H

*** 2012-09-19 More web site files - 7 Files
Here are the Worship files. 
 
**** 3A  Regular Services: Need links to Nursery doc and photos.  But
      photos should go after the service times.  
**** 3B  Summer Services: Needs link to Nursery doc.  Photo?
**** 3C  Holiday Services: Needs photos
**** 3D  Music:  Needs Link to organ file (attached).
**** 3E  Nursery:  Needs photos.
**** 3F  Podcasts:  This is the list of podcasts in the format we have
  now.  The only request is to include an option to subscribe to the
  podcasts.  Is this possible? 

*** 2012-09-20 Ignore 4B
 
** Action items
From Gerard: add option to subscribe to podcasts.

** 2012-09-27 
*** /photos/otherpages
I am organizing the photos according to potentials for each page

The "headline photos" have aspect ratio 3.5 x 1
*** Mike added a widgit for contact
*** Mike added something for maps
*** There are two other emails I need to document here.
*** To Gerard
staff
- anne
ministries
- readers
- communications
- craft faire
- YMART
- children's musical
- recycle
- blessing of the bicyles
- blessing of the animals
Should we say something about being a composting place
emails
newsletter
photgraphy
etc?

We already have a contact us button on is the sidebar.


** 2012-10-08
**** 2C (Anne's bio)
Retirement brought Anne back to Davis and to St. Martin’s which she
had  first attended in 1987 as a parishioner. St Martin’s sponsored
her for ordination and then in 1992 hired her as an assistant with a
primary focus on education for all ages. In 1999 she was asked to
serve as interim rector at St. Paul’s Benicia and then later at
Ascension Vallejo.  In 2002 she moved to Idaho to serve as the rector
of Trinity Episcopal Church in Pocatello. 

In her nine years in Idaho she took up snowshoeing and adopted her
first German shepherd. She’s long enjoyed hiking, gardening, reading,
music and conversation with friends. She has 2 daughters: one with a
masters degree in international development and gender issues and the
other finishing a bachelors in interior design. Both will warn you
about playing scrabble with her.


**** 2C (Jennifer's bio)
This goes in 2C Staff / Vestry after Janie's bio and it needs a photo of Jennifer.
 
Jennifer Maloney, Children’s & Youth Ministry Administrator
 
Jennifer comes to California and St. Martin by way of Memphis, Tennessee.  Previously she has worked in both the banking and investment industries. Before moving to California and placing her career on the back burner to raise her two young children, she held the position of VP of Private Banking for Bank of America.  Additionally Jennifer has always dedicated her time to volunteering and giving to others.  She has spent years serving others in the community by raising funds and serving on numerous boards for not-for-profit organizations.
 
“If you have any questions regarding our Nursery, Children’s or Youth Ministries, please do not hesitate to contact me. I will be happy to spend time discussing all the wonderful programs within our church offered and introduce you to the incredible staff of loving and dedicated teachers we are so lucky to have.”
 
Jennifer@churchofstmartin.org

** 2012-10-10 An inventory of the pages
**** 2 Welcome
***** 2A Welcome [links]
***** 2B Address/Map [done]
***** 2B Contact Us [done]
***** 2C Staff/Vestry [email links] [Anne's email]
***** 2E Ministries [Janet]
text for the following
Centering Prayer Group
Coffee Hour

Hospitality
   cofffee, gifts for new comers, receptions, fellowship dinner,
   stewardship celebration


Communications
Craft Fair
Cursillo
Hospitality

Labyrinth 

Eucharistic Ministers

Eucharistic Visitors

Lectors/Readers

Parish Commission on Ministry  (Charlotte or Nancy Allen or Jerry
Laurie Lovely)

Photography and Cinematography

Podcasts

Church School/Godly Play

Telecom/Technology

Transportation Assistance

Baptismal Pool Guild

Liturgy?

Library

***** 2F Ministries Leaders
***** 2G Labyrinth/Coumbarium [2 links]
There is a phone number which we might want to remove
***** 2H Church History [photos] [Janet]
***** 2I Social Activities [lunch bunch photo] [fellowship dinner photo]

**** 3 Worship
***** 3A Regular Services [done]
***** 3B Summer Services [done]
Needs Nursery Care Link
***** 3C Holiday Services [done]
***** 3D Music [done]
***** 3E Nursery
***** 3F Podcasts

**** 4 Christian Formation
***** 4A Children Grades PreK - 6
***** 4B Youth Grades 7 - 12
***** 4C Adult Ed
***** 4D University/Belfry

**** 5 Serving Others
***** 5A Outreach Program [done]
***** 5B Grants Awarded
***** 5C Davis Community Meals [done]

** 2012-10-13 Thinking about a people table


*** people
| id | name       | email | photo |
|----+------------+-------+-------|
|  1 | Janet Lane |       |       |



*** ministries

| mid | name     | leader-id |
|-----+----------+-----------|
| 123 | outreach |         1 |










*** people page

Janet L

*** ministries page
In case this may help, these are the ministries we would like descriptions of:

Baptismal Pool Guild
Church School/Godly Play
Craft Fair (Carol Boyer)
Cursillo
Environmental Committee (Beth Robbins)
Eucharistic Ministers
Eucharistic Vistors
Hospitality Commission (Sharon Cucinotta or Brian Shontz)
Labyrinth Committee (Janet Lane)
Library
Liturgy
Parish Commission on Ministry
Podcasts
Readers
Telecom/Technology
Transporation Assistance


*** 2012-01-01 Mike: database stuff
I finally got all the database tables to "compile" into a MySQL
database on my PC.  I've attached all the relevant files to this
message, just as a reference and a backup.  We now have to think
about: 

(1) what we want from the tables and

(2) what combination of PHP/MySQL we need to get what we want.

Note that these steps may require going back to step (0) one or more
times.  I.e., "compiling" is never the same as successful execution. 

I think a good way to start would be to sit at my computer and just
invent some queries.  I.e., let's imagine we need a "Ministries" page.
What MySQL commands would give us content suitable for such a page?
We can try this interactively.  If and when we decide we have the
appropriate stuff in the database and the appropriate command(s) to
extract it, we can try making a simple PHP file and making the same
database queries from there. 

If and when that works, we can gussy up the PHP to give us a nicely
formatted web page. 

If and when we have a nice web page from PHP, we can try to figure out
how to call that PHP from Wordpress (functions.php?). 
*** 2012-01-01 make-db.tar.gz
*** 2012-01-02 Mike: Ministries from database via PHP
I've taken the next, halting steps toward using the database on the
web site.  FYI, I've attached a PHP file that uses the query I showed
you this (Thursday) evening to pull some ministry information out of
the database and then displays that information on a web page.  Have a
look at: 

    http://mikehppc2.gh.lan/~mike/mysql/displayMinistriesAndLeaders.php

or if you're not using my name server (hence, can't connect to
"mikehppc2..."), use the numerical address: 

    http://192.168.1.89/~mike/mysql/displayMinistriesAndLeaders.php

BTW, the "login.php" file mentioned in the attached looks something like:

    <?php // login.php
    $db_hostname = 'localhost';
    $db_database = 'people';
    $db_username = 'mike';
    $db_password = 'xxxxxxxxx';
    ?>

I.e., it's a simple way to avoid having to re-type the login
information in every file that references the database, and it
provides a slight bit of obfuscation, as the pw info does not appear
directly in the main PHP file. 

I guess the next step is to figure out how to do this from WP.

Another, back-burner issue is to decide if/how to unify the two
"ministry" pages.  I.e., do we want to put G.'s extended descriptions
into the database (or into a file referenced from the database)?  And
what about all the ministries that don't have extended descriptions?
Etc.
*** 2012-01-02 displayMinistriesAndLeaders.php (Attached previous entry)
<?php

  require_once 'login.php';

  $con = mysql_connect($db_hostname, $db_username, $db_password);
  if (!$con) {
    die('Could not connect: ' . mysql_error());
   }

  mysql_select_db("people", $con);

  $result = mysql_query(
       "SELECT ministries.name, persons.firstName, persons.lastName FROM
       ministries, persons, relateMinistriesToLeaders as rmtl WHERE
       ministries.ministryID = rmtl.ministryID AND
       persons.personID = rmtl.leaderID ORDER BY
       ministries.name");

 
  echo "<table border='1'>
  <tr>
    <th>Ministry</th>
    <th>Leader Name</th>
  </tr>";
 
  while($row = mysql_fetch_array($result)) {
    echo "<tr>";
    echo "<td>" . $row['name']      . "</td>";
    echo "<td>" . $row['firstName'] . " " .
                  $row['lastName']  ."</td>";
    echo "</tr>";
  }
  echo "</table>";
 
  mysql_close($con);
  ?>
*** 2012-10-02 Mike: Fw: [WordPress.org Forums] How to run my own PHP script from a WP page?
----- Forwarded Message -----
From: WordPress.org <noreply@wordpress.org>
To: jm_hannon@yahoo.com 
Sent: Sunday, November 4, 2012 1:44 AM
Subject: [WordPress.org Forums] How to run my own PHP script from a WP page?

Seacoast Web Design wrote:

Create a Page Template that includes your personalized PHP and/or HTML and assign it to a page or use one of the default page template names...assign template to the page(s).
http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates



Read this post on the forums: http://wordpress.org/support/topic/how-to-run-my-own-php-script-from-a-wp-page?replies=3#post-3333862

*** 2012-10-12 Mike: some progress
FYI, I've created a custom page template that allows me to put my PHP
code into a WP page.  At the moment it doesn't integrate at all with
the rest of the environment, but it's a start.  I.e., there's no
header, no sidebar, etc.  Have a look at the last menu item under
"Welcome/About Us".  I'll poke around later on Monday to see if I can
include the missing features (sidebar, etc.). 
*** 2012-11-06 Mike: the custom database tables, etc.
For our reference, I've appended the current contents of the "xstm_" tables,
the ones that I used for the custom web page.

The "machinery" to generate the tables is stored on the ubuntu site:

    ubuntu@ip-10-252-38-202:~/mysql$ pwd
    /home/ubuntu/mysql
    
    ubuntu@ip-10-252-38-202:~/mysql$ ls
    displayMinistriesAndLeaders.php           makeMinistriesSQL.R
    makeRelMinToLeaders.sql.old
    displayMinistriesAndLeaders.php.20121105  makeMinistryLeaders.sql
    ministriesAndLeadersUnn.org
    displayMinistriesAndLeaders.sql           makeMinistryLeaders.sql.old
    ministriesAndLeadersUnn.txt
    foo.html                                  makeMinistryLeadersSQL.R
    ministries.org
    login.php                                 makePersons.sql
    ministries.txt
    make-db.sql                               makePersons.sql.old
    ministryLeaders.org
    Makefile                                  makePersonsSQL.R
    ministryLeaders.txt
    makeMinistries.sql                        makeRelMinToLeaders.R
    persons.org
    makeMinistries.sql.old                    makeRelMinToLeaders.sql
    persons.txt

With a little care and hacking, all of the tables can be generated in about
ten minutes using the procedures listed above.  I'll describe the process
later.  Note that small modifications to the tables can be made "by hand",
using mysql (or similar), rather than regenerating the whole set of tables,
although that does run the risk that the "source" files above will be out of
synch with the working tables.

Note that the Wordpress stuff is located in /var/www/... on the Ubuntu system.

-- Mike


ubuntu@ip-10-252-38-202:~/mysql$ mysql -u root -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 39004
Server version: 5.5.24-0ubuntu0.12.04.1 (Ubuntu)

Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> use stmdb
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+--------------------------------+
| Tables_in_stmdb                |
+--------------------------------+
| stm_commentmeta                |
| stm_comments                   |
| stm_links                      |
| stm_options                    |
| stm_postmeta                   |
| stm_posts                      |
| stm_term_relationships         |
| stm_term_taxonomy              |
| stm_terms                      |
| stm_usermeta                   |
| stm_users                      |
| xstm_ministries                |
| xstm_ministryLeaders           |
| xstm_persons                   |
| xstm_relateMinistriesToLeaders |
+--------------------------------+
15 rows in set (0.00 sec)

mysql> select * from xstm_ministries;
+------------+----------------------------------+----------+
| ministryID | name                             | category |
+------------+----------------------------------+----------+
|          1 | Acolyte Program                  | Liturgy  |
|          2 | Administrator/ Office Volunteers | Utility  |
|          3 | Altar Guild                      | Liturgy  |
|          4 | Belfry University Ministry       | Utility  |
|          5 | Buildings and Grounds            | Utility  |
|          6 | Centering Prayer Group           | xxxxxx   |
|          7 | Child care/Nursery (Sundays)     | Utility  |
|          8 | Choir, Children                  | Liturgy  |
|          9 | Choirs, Adult                    | Liturgy  |
|         10 | Coffee Hour (coffee)             | Utility  |
|         11 | Coffee Hour (food)               | Utility  |
|         12 | Communications Commission        | Utility  |
|         13 | Concerts and Concert Series      | Utility  |
|         14 | Craft Fair                       | Utility  |
|         15 | Cursillo                         | xxxxxx   |
|         16 | Davis Community Meal Liaison     | Utility  |
|         17 | Education for Ministry (EFM)     | Utility  |
|         18 | Eucharistic Visitors             | Caring   |
|         19 | Flower Guild                     | Liturgy  |
|         20 | Healing Ministry                 | Caring   |
|         21 | Helping Hands                    | Caring   |
|         22 | Holy Folders                     | Utility  |
|         23 | Holy Rollers                     | Caring   |
|         24 | Hospitality                      | Utility  |
|         25 | Intercessory Prayers             | Caring   |
|         26 | Junior Warden                    | Utility  |
|         27 | Labyrinth Cleaning               | Utility  |
|         28 | Lay Eucharistic Ministers        | Liturgy  |
|         29 | Lector/Readers                   | Liturgy  |
|         30 | Library Books                    | Utility  |
|         31 | Music Director                   | Liturgy  |
|         32 | Newsletter Editor                | Utility  |
|         33 | Order of St. Luke                | Caring   |
|         34 | Outreach Commission              | Utility  |
|         35 | Parish Commission on Ministry    | Utility  |
|         36 | Photography                      | Utility  |
|         37 | Podcasts of services             | Utility  |
|         38 | Quiet Days                       | Caring   |
|         39 | Senior Warden                    | Utility  |
|         40 | Stephen Ministry                 | Caring   |
|         41 | Stewardship Chair                | Utility  |
|         42 | Sunday School/Godly Play         | Liturgy  |
|         43 | Telecom/Technology               | Utility  |
|         44 | Transportation Assistance        | Caring   |
|         45 | Treasurer                        | Utility  |
|         46 | Ushers/Greeters                  | Liturgy  |
|         47 | Volunteer Gifts                  | Utility  |
|         48 | Webmaster                        | Utility  |
|         49 | Worship                          | Liturgy  |
|         50 | Youth Group (TYGMOS)             | Utility  |
+------------+----------------------------------+----------+
50 rows in set (0.00 sec)

mysql> show tables;
+--------------------------------+
| Tables_in_stmdb                |
+--------------------------------+
| stm_commentmeta                |
| stm_comments                   |
| stm_links                      |
| stm_options                    |
| stm_postmeta                   |
| stm_posts                      |
| stm_term_relationships         |
| stm_term_taxonomy              |
| stm_terms                      |
| stm_usermeta                   |
| stm_users                      |
| xstm_ministries                |
| xstm_ministryLeaders           |
| xstm_persons                   |
| xstm_relateMinistriesToLeaders |
+--------------------------------+
15 rows in set (0.00 sec)

mysql> select * from xstm_ministryLeaders;
+----------+----------+
| leaderID | personID |
+----------+----------+
|        1 |        1 |
|        2 |        2 |
|        3 |        3 |
|        4 |        4 |
|        5 |        5 |
|        6 |        6 |
|        7 |        7 |
|        8 |        8 |
|        9 |        9 |
|       10 |       10 |
|       11 |       11 |
|       12 |       12 |
|       13 |       13 |
|       14 |       14 |
|       15 |       15 |
|       16 |       16 |
|       17 |       17 |
|       18 |       18 |
|       19 |       19 |
|       20 |       20 |
|       21 |       21 |
|       22 |       22 |
|       23 |       23 |
|       24 |       24 |
|       25 |       25 |
|       26 |       26 |
|       27 |       27 |
|       28 |       28 |
|       29 |       29 |
|       30 |       30 |
|       31 |       31 |
|       32 |       32 |
|       33 |       33 |
|       34 |       34 |
|       35 |       35 |
|       36 |       36 |
|       37 |       37 |
|       38 |       38 |
|       39 |       39 |
|       40 |       40 |
|       41 |       41 |
|       42 |       42 |
|       43 |       43 |
|       44 |       44 |
|       45 |       45 |
|       46 |       46 |
+----------+----------+
46 rows in set (0.00 sec)

mysql> show tables;
+--------------------------------+
| Tables_in_stmdb                |
+--------------------------------+
| stm_commentmeta                |
| stm_comments                   |
| stm_links                      |
| stm_options                    |
| stm_postmeta                   |
| stm_posts                      |
| stm_term_relationships         |
| stm_term_taxonomy              |
| stm_terms                      |
| stm_usermeta                   |
| stm_users                      |
| xstm_ministries                |
| xstm_ministryLeaders           |
| xstm_persons                   |
| xstm_relateMinistriesToLeaders |
+--------------------------------+
15 rows in set (0.00 sec)

mysql> select * from xstm_persons;
+----------+-------------+----------------+----------------------------------+-------------+
| personID | firstName   | lastName       | email                            |
role        |
+----------+-------------+----------------+----------------------------------+-------------+
|        1 | Adam        | Russ           | rmr.russ@math.com                |
Coordinator |
|        2 | Alice       | Borchers       | alicedb@sbcglobal.net            |
Coordinator |
|        3 | Alison      | Pease          | alisonmp@gmail.com               |
Coordinator |
|        4 | Anne        | Duffey         | aduffey@dcn.davis.ca.us          |
Coordinator |
|        5 | Bob         | Holm           | robertholm2@yahoo.com            |
Coordinator |
|        6 | Brian       | Shontz         | shontz@omsoft.com                |
Coordinator |
|        7 | Bruce       | Winterhalder   | winterety@sbcglobal.net          |
Coordinator |
|        8 | Carla       | Harris         | charris05@sbcglobal.net          |
Coordinator |
|        9 | Carol       | Boyer          | carol.boyer@comcast.net          |
Coordinator |
|       10 | Craig       | Harris         | charris06@sbcglobal.net          |
Coordinator |
|       11 | Dawn        | Preisler       | dawnpreisler@sbcglobal.net       |
Coordinator |
|       12 | Dee         | Garcia         | efgarcia@sbcglobal.net           |
Coordinator |
|       13 | Elise       | Keddie         | emkeddie@dcn.davis.ca.us         |
Coordinator |
|       14 | Elizabeth   | Honig          | elizahonig@yahoo.com             |
Coordinator |
|       15 | Elizabeth   | Sagehorn       | Elizabeth@WriteTheFirstTime.com  |
Coordinator |
|       16 | Ernie       | Lewis          | ernie@churchofstmartin.org       |
Coordinator |
|       17 | Fel         | Ramey          | rameyfh@csus.edu                 |
Coordinator |
|       18 | Gail        | Gong           | gailgongster@gmail.com           |
Coordinator |
|       19 | Gerard      | Montana        | gerard@churchofstmartin.org      |
Coordinator |
|       20 | Helen       | Campbell       | hcampbell@pobox.com              |
Coordinator |
|       21 | Janet       | Lane           | jrlane@ucdavis.edu               |
Coordinator |
|       22 | Janie       | Knudsen        | JanieHowardKnudsen@gmail.com     |
Coordinator |
|       23 | Jan         | Sanders        | jan@churchofstmartin.org         |
Coordinator |
|       24 | Jim         | Borchers       | jimborchers@sbcglobal.net        |
Coordinator |
|       25 | Jim         | Cheney         | jacheney@ucdavis.edu             |
Coordinator |
|       26 | John        | Reeves         | jeree@pacbell.net                |
Coordinator |
|       27 | Kim         | Andrup         | keandrup@hotmail.com             |
Coordinator |
|       28 | Lisa        | Leigh          | lhalko@comcast.net               |
Coordinator |
|       29 | Lynn        | Zender         | LynnZender@sbcglobal.net         |
Coordinator |
|       30 | Margaret    | Grayden        | mgrayden@cal.net                 |
Coordinator |
|       31 | Mark        | Allen          | mark@churchofstmartin.org        |
Coordinator |
|       32 | Mary        | Briggs         | briggs4598@gmail.com             |
Coordinator |
|       33 | Mary Honour | Gottschalk     | honourL@hotmail.com              |
Coordinator |
|       34 | Mike        | Hannon         | jm_hannon@yahoo.com              |
Coordinator |
|       35 | Mike        | Rushton        | jamrushton@comcast.net           |
Coordinator |
|       36 | Nancy       | Allen          | akanancy@sbcglobal.net           |
Coordinator |
|       37 | Nancy       | Crummey        | ncrummey@urcad.org               |
Coordinator |
|       38 | Nate        | Hannon         | lordoftheabeliangroups@gmail.com |
Coordinator |
|       39 | Neil        | Willits        | nhwillits@ucdavis.edu            |
Coordinator |
|       40 | Pierre      | Neu            | neuforyou@sbcglobal.net          |
Coordinator |
|       41 | Renee       | Crevelli-Gross | cregross@comcast.net             |
Coordinator |
|       42 | Robert      | Lynch          | robert.b.lynch@gmail.com         |
Coordinator |
|       43 | Russ        | Bruch          | rab4jc@gmail.com                 |
Coordinator |
|       44 | Sharon      | Cucinotta      | sharndan57@att.net               |
Coordinator |
|       45 | Stephen     | Lawrence       | redoaktree2@yahoo.com            |
Coordinator |
|       46 | The         | Staff          | info@churchofstmartin.org        |
Coordinator |
+----------+-------------+----------------+----------------------------------+-------------+
46 rows in set (0.00 sec)

mysql> show tables;
+--------------------------------+
| Tables_in_stmdb                |
+--------------------------------+
| stm_commentmeta                |
| stm_comments                   |
| stm_links                      |
| stm_options                    |
| stm_postmeta                   |
| stm_posts                      |
| stm_term_relationships         |
| stm_term_taxonomy              |
| stm_terms                      |
| stm_usermeta                   |
| stm_users                      |
| xstm_ministries                |
| xstm_ministryLeaders           |
| xstm_persons                   |
| xstm_relateMinistriesToLeaders |
+--------------------------------+
15 rows in set (0.00 sec)

mysql> select * from xstm_relateMinistriesToLeaders;
+------------+----------+
| ministryID | leaderID |
+------------+----------+
|         44 |        1 |
|         21 |        2 |
|         34 |        3 |
|         19 |        4 |
|         11 |        5 |
|         24 |        6 |
|         37 |        7 |
|         40 |        8 |
|         14 |        9 |
|         43 |       10 |
|          3 |       11 |
|         42 |       12 |
|          4 |       13 |
|         30 |       14 |
|         32 |       15 |
|         28 |       16 |
|         36 |       17 |
|         36 |       18 |
|          9 |       19 |
|         13 |       19 |
|         31 |       19 |
|         27 |       20 |
|         11 |       21 |
|         16 |       21 |
|         26 |       21 |
|          8 |       22 |
|          2 |       23 |
|         29 |       23 |
|         21 |       24 |
|          4 |       25 |
|          5 |       26 |
|          6 |       27 |
|         42 |       28 |
|         50 |       28 |
|         47 |       29 |
|         20 |       30 |
|         40 |       30 |
|         49 |       31 |
|         48 |       32 |
|          7 |       33 |
|         12 |       34 |
|         16 |       34 |
|         35 |       36 |
|          3 |       37 |
|         36 |       38 |
|         16 |       39 |
|         41 |       39 |
|         39 |       40 |
|         34 |       41 |
|          1 |       42 |
|         50 |       42 |
|         15 |       43 |
|         46 |       43 |
|         10 |       44 |
|         24 |       44 |
|         45 |       45 |
|         17 |       46 |
|         18 |       46 |
|         22 |       46 |
|         23 |       46 |
|         25 |       46 |
|         33 |       46 |
|         38 |       46 |
+------------+----------+
63 rows in set (0.00 sec)

mysql> Bye

** 2012-11-09 How to increase the upload file size
###### Change the PHP configuration
$ sudo diff /etc/php5/apache2/php.ini /etc/php5/apache2/php.ini.20121109
891c891
< upload_max_filesize = 72M
---
> upload_max_filesize = 8M

###### Restart the web server
$ sudo invoke-rc.d apache2 stop
 * Stopping web server apache2      ... waiting                  [ OK ]
$ sudo invoke-rc.d apache2 start
 * Starting web server apache2      

I believe that in php.ini, we need to make the following two changes
upload_max_filesize = 72M
post_max_size = 72 M

** 2012-11-09 Newsletters
Add New Post > Title eg December 2012 Newsletter 
Categories > Newsletter
Inside our December Newsletter, you will find:
Use an itemized list

Use Heading 3 to type 
Click here for the December 2012 Newsletter 


Name the newsletter file 2012-12-newsletter.pdf and add it to
newsletters folder.  

Put cursor at the bottom of the page
Click on Upload/insert
Drop in 2012-12-newsletter.pdf
Title Click here for the December 2012 Newsletter
File URL
Insert into Post

** 2012-11-09 Podcasts
*** Scott used Podcasting Plugin by TSG
We installed this plugin and copied all of Scott's settings
*** How to add a media file
We are following the video here
http://docs.podcastingplugin.com/setup/adding-a-media-file/

Add new post
Add title 
Categories podcasts
Copy title to body and change it to Heading 2
Upload media
Insert into Post
Publish
Click two lines after Heading 2 line
Send to Editor
Add a line feed
Delete the link created by Insert into post
Update

View post
Click on play button to hear the service.

** 2012-12-03 links
Highlight the link
Click on the link button

mailto:info@churchofstmartin.org


* 2012-12-13 It went live
** 2012-12-12 This has all happended before; it will all
It turns out that I described the PermaLink problem, and the solution, back in
September, long enough ago for us both to forget.

As I noted at the time, the use of the top-level directory for the web site
complicates the issue.  I.e., instead of using the default:

    /var/www/wordpress

we're stuffing all the wordpress stuff into:

    /var/www

(This is so that "wordpress" doesn't appear in our URL's, as, for example:

    http://churchofstmartin.org/wordpress/outreach

We have instead:

    http://churchofstmartin.org/outreach

I suspect that there's some clever apache trick that would obviate the need to
do this, but I've been unable to find it.)

Here are some details:

It is at least convenient to make the www directory writable by the web
server.  The result (after using chgrp and chmod):

    mike@ubuntu:/var$ pwd
    /var

    mike@ubuntu:/var$ ls -ld www
    drwxrwxr-x 7 root www-data 4096 Dec 12 18:12 www

I.e., now the associated group is the apache group, "www-data", and the group
has write access to the www directory.

In order to be able to use the PermaLink stuff, we have to do several things:

(1) Put a file ".htaccess" into the top-level directory:

    mike@ubuntu:/var/www$ pwd
    /var/www

    mike@ubuntu:/var/www$ ls -l .htaccess
    -rw-r--r-- 1 www-data www-data 236 Dec 12 18:15 .htaccess

This file contains a bunch of obscure (to me) apache directives that tell
apache how to rewrite the URL's in a "pretty" fashion.  The contents of the
file are generated when you visit the Settings-->PermaLinks page in the
Wordpress dashboard.

(2) Next we have to ENABLE the kind of URL rewriting that is indicated in
.htaccess.  There's some Ubuntu utility that does this, but all it does is
make a symbolic link, as:

    mike@ubuntu:/etc/apache2/mods-enabled$ pwd
    /etc/apache2/mods-enabled

    mike@ubuntu:/etc/apache2/mods-enabled$ ls -l rewrite.load
    lrwxrwxrwx 1 root root 30 Dec 12 14:30 rewrite.load ->
    ../mods-available/rewrite.load

(So:

    cd /etc/apache2/mods-enabled
    ln -s ../mods-available/rewrite.load rewrite.load
)

(3) Now we've enabled the rewrite capability in general, but we also have to
tell apache it's OK to USE that capability in specific places.  In particular,
we tell apache that for the default site (we have only one anyway, but there
could be other sites on the same computer) it's OK to rewrite in:

       <Directory /var/www/>

i.e., the place where our Wordpress stuff is stored.

A simple edit of the file is all that's required.  Here's the result:

    mike@ubuntu:/etc/apache2/sites-available$ pwd
    /etc/apache2/sites-available

    mike@ubuntu:/etc/apache2/sites-available$ ls
    default  default.20121212  default-ssl

    mike@ubuntu:/etc/apache2/sites-available$ diff default default.20121212
    11,12c11
    <         ###### AllowOverride None
    <         AllowOverride FileInfo
    ---
    >         AllowOverride None
    
Once we've got this all done, we have to restart apache.  On Ubuntu:

    sudo invoke-rc.d apache2 stop
    sudo invoke-rc.d apache2 start

** 2012-12-12 Restoring from the WP backup
To restore the WP database from the backup, we have to first go through the
initial steps of the database set-up.  See, for instance, the section:

    Using MySQL Client

on the page:

    http://codex.wordpress.org/Installing_WordPress#Detailed_Instructions

All of the required information is listed in the file:

    wp-config.php

which is part of the backup currently done to my old PC (see
mikehppc:/home/mike/Documents/stm/backup/).  In particular, we look for:

    define('DB_NAME', 'stmartin_wrdp1');    // The name of the database
    define('DB_USER', 'stmartin_wrdp1');     // Your MySQL username
    define('DB_PASSWORD', 'thisIsNotThePassword'); // ...and password

Take the database name, user name, and password and stuff them into the
instructions given in the Wordpress-installation guide (above).

After that, you go to mysql as the WP user:

    mysql -u stmartin_wrdp1 -p
    <enter the password from the file>

Then tell mysql that you want to work on our DB:

    use stmartin_wrdp1;

Then restore from the dump of the database:

    source stmartin_wrdp1_wp_20121206_101.sql

The database dump is also included as part of the backup.  I don't know the
algorithm for generating the name, but the date is obviously part of it.  The
name above is the one I used today.

Note that there is no semi-colon after the "source" command.

The rest of the restoration process consists of:

(1) Copying (or generating) the .htaccess file from the backup to:

    /var/www/

(or whatever is the root directory for the WP stuff).

(2) Copying wp-config.php to /var/www/

(3) Copying (recursively) the wp-content directory from the backup to
/var/www/.  E.g.,

    cd <directory where backup stuff is located>
    sudo rsync -a wp-content /var/www/

(4) It's probably good to make sure that the apache user owns all the content:

    cd /var/www
    sudo chown -R www-data.www-data wp-content 

** 2012-12-13 5:36 New name servers. FYI
I've made the change!  With some propagation delay,
"churchofstmartin.org" should now point to Amazon.  We'll see. 

Old servers (MediaServe)

DNS1.CQSERVERS.COM
DNS2.CQSERVERS.COM

New servers (Amazon)

ns-1698.awsdns-20.co.uk
ns-830.awsdns-39.net
ns-476.awsdns-59.com
ns-1128.awsdns-13.org

** 2012-12-14 1:30 a DNS and other stuff
Hi, Dear.  FYI, I finally managed to flush the DNS cache on my old PC
(the system we use for name service around here), so I think everybody
should now be getting the new address. 

Also, I've changed:

    Settings --> General --> WordPress Address (URL)

to:

    http://churchofstmartin.org

Ditto for:

    Settings --> General --> Site Address (URL)

This seems to have had the salubrious effect of replacing references
to the Amazon name ("ec2...") with the intended name
("churchofstmartin.org").  In other words, if you navigate away from
the front page, say to: 

    Worship --> Music

the URL will be:

    http://churchofstmartin.org/music-at-st-martins/

as we would hope.

BTW, the following page was helpful in this:

    http://codex.wordpress.org/Changing_The_Site_URL

-- Mike

** 2012-12-14 1:48 a Changing the links
FYI, I had to relink the "Announcements", "Newsletter", etc., on the
front page to get their URL's to display as
"churchofstmartin.org/something".  The standard Wordpress procedure
worked just fine for this, i.e., 

    On the "Edit Page" page:

        Drag the mouse over the word

        Select the Link icon (looks like a dumbbell)

        Choose "Link to existing content" (or similar)

        Select the appropriate page (e.g., "Announcements")

but I DID have to go through the process for each of the links.  We'll
need to be on the lookout for other things of this nature. 

** 2012-12-14 1:52 a Dates are gone from the announcement page
FYI, I just commented out the reference to the "the_time" function in
displayAnnouncements.php (see the appended for the diff).  That made
the date go away on the Announcements page.  I think this looks a lot
nicer. 

-- Mike

$ diff displayAnnouncements.php displayAnnouncements.php.20121214
20,22c20,22
<     ////// echo "<h3>";
<       ////// the_time('F jS, Y');
<     ////// echo "</h3>";
---
>     echo "<h3>";
>       the_time('F jS, Y');
>     echo "</h3>";


** 2012-12-14 facebook and twitter
Use the floating social media settings plugin
http://www.facebook.com/pages/The-Episcopal-Church-of-St-Martin-Davis-CA/120720071291771

** 2012-12-14 post expirator installed
We are wondering if this works.  Waiting to see if eventually the
announcements that have an expiration data will turn into drafts.
